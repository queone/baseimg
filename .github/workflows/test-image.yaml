name: Manually Test New Image

on:
  workflow_dispatch:

jobs:
  test-image:    
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/queone/cntimage:1.0.0

    steps:
      - name: Authenticate to GHCR
        run: echo "${{ secrets.GHCR_PAT }}" | docker login ghcr.io -u ${{ github.actor }} --password-stdin

      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          ref: main

      - name: Setup Go environment
        uses: actions/setup-go@v5
        with:
          go-version: '1.23.4'

      - name: Test commands
        run: |
          Gre='\e[1;32m' Red='\e[1;31m' Pur='\e[1;35m' Yel='\e[1;33m' Blu='\e[1;34m' Rst='\e[0m'
          printf "${Gre}START${Rst}\n"
          git --version
          ls -l
          cat /etc/os-release
          uname -m
          go version
          vault version
          printf "${Red}END!${Rst}\n"
